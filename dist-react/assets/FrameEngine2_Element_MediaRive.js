import{R as B,a as e,o as _,p as b,q as w,t as C,j as v}from"./visualization.js";const k=({elementId:r,properties:y,width:F,height:I,onRiveDiscovery:o})=>{const{filename:i=null,autoplay:p=!0,backgroundColor:R="transparent",riveStateMachine:a,riveInputs:l,riveBindings:c}=y,[u,h]=e.useState([]),[d,m]=e.useState([]),t=e.useMemo(()=>{if(i)return i.startsWith("http")||i.startsWith("blob:")?i:`/api/frameengine/rive/${i}/content`},[i]),g=e.useMemo(()=>t?{src:t,autoplay:p,autoBind:!0,stateMachines:a?[a]:void 0,automaticallyHandleEvents:!0}:null,[t,p,a]),{RiveComponent:x,rive:n}=_.useRive(g||{src:"",autoplay:!1}),M=e.useMemo(()=>({width:"100%",height:"100%",position:"relative",userSelect:"none",pointerEvents:"none"}),[]),S=e.useMemo(()=>({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f0f0f0",color:"#999",fontSize:"12px",textAlign:"center",padding:"8px",userSelect:"none"}),[]);return e.useEffect(()=>{if(!n||!t){h([]),m([]);return}let f=!1;const j=setTimeout(()=>{f||b(n).then(({machines:s,bindings:E})=>{f||(h(s),m(E),o&&o(r,s,E))}).catch(s=>{console.error(`[FrameEngine2_Element_MediaRive] Rive discovery failed for element ${r}:`,s)})},100);return()=>{f=!0,clearTimeout(j)}},[n,t,r,o]),e.useEffect(()=>{!n||!l||u.length===0||w(u,l)},[n,l,u]),e.useEffect(()=>{!n||!c||d.length===0||C(d,c)},[n,c,d]),!t||!g?v.jsx("div",{style:S,children:"No Rive file selected"}):v.jsx("div",{style:M,children:v.jsx(x,{style:{width:"100%",height:"100%",display:"block",backgroundColor:R}})},t)},A=B.memo(k);export{A as default};
